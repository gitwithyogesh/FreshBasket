<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>FreshBasket</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="color-scheme" content="light dark">
    <link rel="stylesheet" href="style1.css" />

</head>

<body data-theme="light">
    <div class="wrap">
        <!-- HEADER -->
        <header>
            <a href="#home" style="text-decoration: none">
                <div class="brand">
                    <div class="logo">FB</div>
                    FreshBasket
                </div>
            </a>

            <div class="actions">
                <div class="auth-row">
                    <button class="toggle-theme icon-btn" id="themeToggle" title="Toggle theme">üåó</button>
                    <button class="icon-btn" id="openLogin">Login</button>
                </div>

                <nav class="desktop" id="navDesktop">
                    <a href="#home">Home</a>
                    <a href="#products">Products</a>
                    <a href="#offers">Offers</a>
                    <a href="#contact">Contact</a>
                </nav>

                <button class="hamburger" id="hambtn" aria-label="menu">
                    <div></div>
                    <div></div>
                    <div></div>
                </button>

                <button class="icon-btn" id="openCartBtn" aria-label="open cart">
                    üõí <span id="cartCountBadge" class="cart-badge"
                        style="margin-left:8px; display:inline-block;">0</span>
                </button>
            </div>
        </header>

        <!-- HERO + Carousel -->
        <section class="hero">
            <div class="hero-left">
                <h1>Fresh groceries delivered to your door</h1>
                <p class="muted">Locally sourced fruits, vegetables, dairy & pantry essentials ‚Äî fast delivery.</p>

                <div class="searchbar" style="margin-top:14px; align-items:center;">
                    <div style="flex:1;position:relative" class="search-suggestions">
                        <input id="searchInput" type="search" placeholder="Search for fruits, vegetables..."
                            autocomplete="off" />
                        <div id="suggestions" class="suggestions"></div>
                    </div>
                    <button id="searchBtn" class="icon-btn"
                        style="background:var(--primary);color:white;border-radius:10px">Search</button>
                </div>

                <!-- category chips -->
                <div class="catbar" id="categoryBar" style="margin-top:18px"></div>

                <!-- carousel offers -->
                <div id="offers" style="margin-top:16px">
                    <div class="carousel" id="carousel">
                        <div class="carousel-track" id="carouselTrack">
                            <!-- slides inserted by JS -->
                        </div>
                    </div>
                    <div class="dots" id="carouselDots"></div>
                </div>
            </div>

            <div class="hero-right">
                <img id="heroImage" src="https://t4.ftcdn.net/jpg/04/29/82/93/360_F_429829305_hnlwKXMrdbiggNhIIQiuu3YxkAuNqJbN.jpg" alt="hero" />
            </div>
        </section>

        <!-- PRODUCTS GRID -->
        <main>
            <h3 id="products">Popular picks</h3>
            <div class="divider"></div>

            <!-- loader skeleton -->
            <div id="skeletonWrap" class="grid" style="margin-bottom:16px">
                <!-- skeleton cards -->
            </div>

            <div id="productGrid" class="grid" aria-live="polite"></div>
        </main>
    </div>

    <!-- CART PANEL -->
    <aside class="cart-panel" id="cartPanel" aria-hidden="true">
        <h3>Your cart</h3>
        <div id="cartItemsWrap"></div>
        <div class="divider"></div>
        <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
                <div class="muted">Subtotal</div>
                <div style="font-weight:800;font-size:18px">‚Çπ<span id="cartTotal">0</span></div>
            </div>
            <div style="display:flex;flex-direction:column;gap:8px">
                <button id="checkoutBtn" class="btn icon-btn"
                    style="background:var(--primary);color:white;border-radius:10px;padding:10px 14px">Checkout</button>
                <button id="closeCartBtn" class="icon-btn">Close</button>
            </div>
        </div>
    </aside>

    <div class="overlay" id="overlay"></div>

    <!-- TOASTS -->
    <div class="toastwrap" id="toastWrap"></div>

    <!-- QUICK VIEW MODAL -->
    <div class="modal" id="quickModal" aria-hidden="true">
        <div class="modal-card" id="quickCard">
            <button id="quickClose" class="icon-btn" style="float:right">‚úï</button>
            <img id="quickImg" src="" alt="product" />
            <h3 id="quickTitle"></h3>
            <div id="quickDesc" class="muted"></div>
            <div style="display:flex;gap:10px;margin-top:12px">
                <div style="font-weight:800;font-size:18px">‚Çπ<span id="quickPrice">0</span></div>
                <button id="quickAdd" class="icon-btn"
                    style="background:var(--primary);color:#fff;border-radius:10px">Add to cart</button>
            </div>
        </div>
    </div>

    <!-- LOGIN / SIGNUP MODAL -->
    <div class="modal" id="authModal" aria-hidden="true">
        <div class="modal-card">
            <button id="authClose" class="icon-btn" style="float:right">‚úï</button>
            <h3 id="authTitle">Login</h3>
            <div style="display:flex;gap:8px;margin-top:12px">
                <input id="authEmail" placeholder="Email" type="email" required
                    style="flex:1;padding:10px;border-radius:8px;border:1px solid rgba(0,0,0,0.06)" />
                <input id="authPass" placeholder="Password" type="password" required
                    style="flex:1;padding:10px;border-radius:8px;border:1px solid rgba(0,0,0,0.06)" />
            </div>
            <div style="display:flex;gap:8px;margin-top:12px;justify-content:flex-end">
                <button id="authCancel" class="icon-btn">Cancel</button>
                <button id="authSubmit" class="icon-btn"
                    style="background:var(--primary);color:#fff;border-radius:8px">Submit</button>
            </div>
            <div style="margin-top:10px" class="muted">This is UI-only demo (no backend).</div>
        </div>
    </div>


    <!-- PROFESSIONAL FOOTER -->
    <footer class="footer">
        <div class="footer-container">

            <!-- Column 1 -->
            <div class="footer-col">
                <h4>FreshBasket</h4>
                <p class="muted">
                    Your trusted partner for fresh groceries delivered fast, safe, and hassle-free.
                </p>
            </div>

            <!-- Column 2 -->
            <div class="footer-col">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="#home">Home</a></li>
                    <li><a href="#products">Products</a></li>
                    <li><a href="#offers">Offers</a></li>
                    <li><a href="#contact">Contact</a></li>
                </ul>
            </div>

            <!-- Column 3 -->
            <div class="footer-col">
                <h4>Customer Support</h4>
                <ul>
                    <li><a href="#">FAQ</a></li>
                    <li><a href="#">Shipping Info</a></li>
                    <li><a href="#">Refund Policy</a></li>
                    <li><a href="#">Terms & Conditions</a></li>
                </ul>
            </div>

            <!-- Column 4 -->
            <div class="footer-col">
                <h4>Stay Updated</h4>
                <input type="email" placeholder="Enter your email" class="newsletter-input" />
                <button class="newsletter-btn">Subscribe</button>

                <div class="social-icons">
                    <a href="#">üåê</a>
                    <a href="#">üìò</a>
                    <a href="#">üì∏</a>
                    <a href="#">üê¶</a>
                </div>
            </div>

        </div>

        <div class="footer-bottom">
            ¬© 2025 FreshBasket ‚Äî All Rights Reserved.
        </div>
    </footer>



    <script>
        // ---------------------------
        // Sample product dataset
        // ---------------------------
        const PRODUCTS = [
            { id: 1, name: 'Banana (1 dozen)', category: 'Fruits', price: 60, img: 'https://m.media-amazon.com/images/I/51W9iO9AwhL._AC_UF1000,1000_QL80_.jpg', desc: 'Sweet ripe bananas, perfect for breakfast and smoothies.' },
            { id: 2, name: 'Tomato (1kg)', category: 'Vegetables', price: 40, img: 'https://media.istockphoto.com/id/1132371208/photo/three-ripe-tomatoes-on-green-branch.jpg?s=612x612&w=0&k=20&c=qVjDb5Tk3-UccV-E9gqvoz97PTsP1QmBftw27qA9kEo=', desc: 'Fresh juicy tomatoes, farm-picked.' },
            { id: 3, name: 'Cow Milk (1L)', category: 'Dairy', price: 55, img: 'https://media.istockphoto.com/id/1297005860/photo/raw-milk-being-poured-into-container.jpg?s=612x612&w=0&k=20&c=5Xumh49_zYs9GjLkGpZXM41tS17K8M-svN9jLMv0JpE=' },
            { id: 4, name: 'Potato (1kg)', category: 'Vegetables', price: 35, img: 'https://cdn.mos.cms.futurecdn.net/iC7HBvohbJqExqvbKcV3pP.jpg', desc: 'Starchy potatoes, versatile in cooking.' },
            { id: 5, name: 'Apples (1kg)', category: 'Fruits', price: 200, img: 'https://images.unsplash.com/photo-1567306226416-28f0efdc88ce?q=80&w=800&auto=format&fit=crop&crop=faces', desc: 'Crisp sweet apples, great for snacking.' },
            { id: 6, name: 'Paneer (200g)', category: 'Dairy', price: 90, img: 'https://umamigirl.com/wp-content/uploads/2023/04/How-to-Make-Paneer-at-Home-Umami-Girl.jpg', desc: 'Fresh soft paneer for curry.' },
            { id: 7, name: 'Snacks Pack', category: 'Snacks', price: 45, img: 'https://cdnimg.webstaurantstore.com/uploads/seo_category/2023/11/Individually-Wrapped-Snacks/wrapped-snacks_one.jpg', desc: 'Tasty crunchy snack pack.' },
            { id: 8, name: 'Orange Juice (1L)', category: 'Beverages', price: 120, img: 'https://media.istockphoto.com/id/1158980367/photo/woman-hand-pouring-orange-juice-on-glasses-with-slice-orange-on-wooden-background.jpg?s=612x612&w=0&k=20&c=7eariYAOV0LRcYtl3u05K4vnSN7IJ5X7egV1gu1ALF0=' }
        ];

        // ---------------------------
        // State
        // ---------------------------
        const state = {
            products: PRODUCTS.slice(),
            cart: JSON.parse(localStorage.getItem('fb_cart') || '{}'),
            filter: 'All',
            theme: localStorage.getItem('fb_theme') || 'light',
            search: ''
        };

        // ---------------------------
        // DOM refs
        // ---------------------------
        const productGrid = document.getElementById('productGrid');
        const skeletonWrap = document.getElementById('skeletonWrap');
        const categoryBar = document.getElementById('categoryBar');
        const searchInput = document.getElementById('searchInput');
        const suggestionsEl = document.getElementById('suggestions');
        const openCartBtn = document.getElementById('openCartBtn');
        const cartPanel = document.getElementById('cartPanel');
        const overlay = document.getElementById('overlay');
        const cartItemsWrap = document.getElementById('cartItemsWrap');
        const cartTotal = document.getElementById('cartTotal');
        const cartCountBadge = document.getElementById('cartCountBadge');
        const toastWrap = document.getElementById('toastWrap');
        const quickModal = document.getElementById('quickModal');
        const quickImg = document.getElementById('quickImg');
        const quickTitle = document.getElementById('quickTitle');
        const quickDesc = document.getElementById('quickDesc');
        const quickPrice = document.getElementById('quickPrice');
        const quickAdd = document.getElementById('quickAdd');
        const quickClose = document.getElementById('quickClose');
        const themeToggle = document.getElementById('themeToggle');
        const authModal = document.getElementById('authModal');
        const openLogin = document.getElementById('openLogin');
        const authClose = document.getElementById('authClose');
        const navDesktop = document.getElementById('navDesktop');
        const hambtn = document.getElementById('hambtn');
        const carouselTrack = document.getElementById('carouselTrack');
        const carouselDots = document.getElementById('carouselDots');

        // ---------------------------
        // Util helpers
        // ---------------------------
        function $(sel, root = document) { return root.querySelector(sel) }
        function $all(sel, root = document) { return Array.from(root.querySelectorAll(sel)) }

        function saveCart() { localStorage.setItem('fb_cart', JSON.stringify(state.cart)); }
        function saveTheme() { localStorage.setItem('fb_theme', state.theme) }

        function formatPrice(n) { return Number(n).toFixed(0) }

        // ---------------------------
        // THEME
        // ---------------------------
        (function initTheme() {
            document.body.setAttribute('data-theme', state.theme);
            themeToggle.textContent = state.theme === 'dark' ? '‚òÄÔ∏èTheme' : 'üåôTheme';
            themeToggle.addEventListener('click', () => {
                state.theme = state.theme === 'dark' ? 'light' : 'dark';
                document.body.setAttribute('data-theme', state.theme);
                themeToggle.textContent = state.theme === 'dark' ? '‚òÄÔ∏èTheme' : 'üåôTheme';
                saveTheme();
                showToast('Theme switched');
            })
        })();

        // ---------------------------
        // NAV / HAMBURGER mobile
        // ---------------------------
        hambtn.addEventListener('click', () => {
            navDesktop.classList.toggle('active');
        });

        // close nav when clicking a link (mobile)
        $all('nav a').forEach(a => a.addEventListener('click', () => navDesktop.classList.remove('active')));

        // ---------------------------
        // build categories
        // ---------------------------
        function renderCategories() {
            const cats = ['All', ...new Set(PRODUCTS.map(p => p.category))];
            categoryBar.innerHTML = '';
            cats.forEach(c => {
                const d = document.createElement('div');
                d.className = 'chip' + (state.filter === c ? ' active' : '');
                d.textContent = c;
                d.addEventListener('click', () => {
                    state.filter = c; renderProducts(); renderCategories();
                });
                categoryBar.appendChild(d);
            });
        }

        // ---------------------------
        // Skeleton loader
        // ---------------------------
        function showSkeletons() {
            skeletonWrap.innerHTML = '';
            for (let i = 0; i < 6; i++) {
                const s = document.createElement('div');
                s.className = 'card';
                s.innerHTML = `<div class="skeleton" style="height:160px;border-radius:10px"></div>
        <div style="height:18px" class="skeleton"></div>
        <div style="height:18px;width:60%;margin-top:8px" class="skeleton"></div>`;
                skeletonWrap.appendChild(s);
            }
        }

        // ---------------------------
        // Render products
        // ---------------------------
        function renderProducts() {
            // small delay to simulate loading
            productGrid.innerHTML = '';
            // filtered set
            const q = (state.search || '').toLowerCase();
            const list = state.products.filter(p => {
                if (state.filter !== 'All' && p.category !== state.filter) return false;
                if (q && !(p.name.toLowerCase().includes(q) || p.category.toLowerCase().includes(q))) return false;
                return true;
            });

            if (!list.length) {
                productGrid.innerHTML = `<div style="grid-column:1/-1;padding:24px;background:var(--card);border-radius:12px;text-align:center" class="muted">No items found.</div>`;
                return;
            }

            list.forEach(p => {
                const card = document.createElement('div'); card.className = 'card';
                card.innerHTML = `
        <img src="${p.img}" alt="${p.name}" loading="lazy">
        <div style="display:flex;flex-direction:column;gap:8px">
          <div class="meta"><div style="font-weight:700">${p.name}</div><div class="price">‚Çπ${formatPrice(p.price)}</div></div>
          <div style="display:flex;gap:8px">
            <button class="icon-btn quick" data-id="${p.id}">Quick view</button>
            <button class="icon-btn add" data-id="${p.id}" style="margin-left:auto;background:var(--primary);color:#fff;border-radius:8px;padding:8px 12px">Add</button>
          </div>
        </div>
      `;
                productGrid.appendChild(card);
            });

            // attach handlers
            $all('.card .add').forEach(btn => btn.addEventListener('click', onAddClick));
            $all('.card .quick').forEach(btn => btn.addEventListener('click', onQuick));
            skeletonWrap.innerHTML = ''; // remove skeletons
        }

        // ---------------------------
        // Search suggestions + live search
        // ---------------------------
        function setupSearch() {
            const names = PRODUCTS.map(p => p.name);
            searchInput.addEventListener('input', e => {
                const v = e.target.value.trim();
                state.search = v;
                if (!v) { suggestionsEl.style.display = 'none'; renderProducts(); return }
                const matches = PRODUCTS.filter(p => p.name.toLowerCase().includes(v.toLowerCase()) || p.category.toLowerCase().includes(v.toLowerCase())).slice(0, 6);
                suggestionsEl.innerHTML = '';
                matches.forEach(m => {
                    const it = document.createElement('div'); it.className = 'item';
                    it.innerHTML = m.name.replace(new RegExp(v, 'ig'), match => `<strong>${match}</strong>`) + ` <span class="muted"> ‚Äî ${m.category}</span>`;
                    it.addEventListener('click', () => { searchInput.value = m.name; state.search = m.name; suggestionsEl.style.display = 'none'; renderProducts(); });
                    suggestionsEl.appendChild(it);
                });
                suggestionsEl.style.display = matches.length ? 'block' : 'none';
                // live update products
                renderProducts();
            });

            document.addEventListener('click', (e) => {
                if (!e.target.closest('.search-suggestions')) suggestionsEl.style.display = 'none';
            });
        }

        // ---------------------------
        // TOAST
        // ---------------------------
        function showToast(text, ms = 2500) {
            const t = document.createElement('div'); t.className = 'toast';
            t.textContent = text; toastWrap.appendChild(t);
            // show
            requestAnimationFrame(() => t.classList.add('show'));
            setTimeout(() => { t.classList.remove('show'); setTimeout(() => t.remove(), 300); }, ms);
        }

        // ---------------------------
        // CART logic + UI
        // ---------------------------
        function getCartCount() { return Object.values(state.cart).reduce((s, v) => s + v, 0); }
        function getCartTotal() {
            return Object.keys(state.cart).reduce((s, id) => {
                const p = PRODUCTS.find(x => x.id == id); if (!p) return s; return s + p.price * state.cart[id];
            }, 0);
        }

        function renderCart() {
            cartItemsWrap.innerHTML = '';
            const ids = Object.keys(state.cart).map(Number);
            if (!ids.length) {
                cartItemsWrap.innerHTML = '<div class="muted">Your cart is empty.</div>';
                cartTotal.textContent = '0';
                cartCountBadge.textContent = '0';
                return;
            }

            ids.forEach(id => {
                const p = PRODUCTS.find(x => x.id === id);
                const qty = state.cart[id];
                const div = document.createElement('div'); div.className = 'cart-item';
                div.innerHTML = `
        <img src="${p.img}" alt="${p.name}">
        <div style="flex:1">
          <div style="font-weight:700">${p.name}</div>
          <div class="muted">‚Çπ${p.price} √ó ${qty} = ‚Çπ${p.price * qty}</div>
        </div>
        <div style="display:flex;flex-direction:column;align-items:flex-end;gap:8px">
          <div class="qty">
            <button class="icon-btn dec" data-id="${id}">-</button>
            <span style="padding:6px 8px">${qty}</span>
            <button class="icon-btn inc" data-id="${id}">+</button>
          </div>
          <button class="icon-btn remove muted" data-id="${id}">Remove</button>
        </div>
      `;
                cartItemsWrap.appendChild(div);
            });

            cartTotal.textContent = formatPrice(getCartTotal());
            cartCountBadge.textContent = getCartCount();

            // handlers
            $all('.cart-item .inc').forEach(b => b.addEventListener('click', e => {
                const id = Number(e.currentTarget.dataset.id); changeQty(id, 1);
            }));
            $all('.cart-item .dec').forEach(b => b.addEventListener('click', e => {
                const id = Number(e.currentTarget.dataset.id); changeQty(id, -1);
            }));
            $all('.cart-item .remove').forEach(b => b.addEventListener('click', e => {
                const id = Number(e.currentTarget.dataset.id); removeFromCart(id);
            }));
        }

        function changeQty(id, delta) {
            state.cart[id] = Math.max(0, (state.cart[id] || 0) + delta);
            if (state.cart[id] === 0) delete state.cart[id];
            saveCart(); renderCart();
        }

        function removeFromCart(id) {
            delete state.cart[id]; saveCart(); renderCart(); showToast('Removed from cart');
        }

        // ---------------------------
        // Add-to-cart with fly animation
        // ---------------------------
        function onAddClick(e) {
            const id = Number(e.currentTarget.dataset.id);
            const product = PRODUCTS.find(p => p.id === id);
            // increment cart
            state.cart[id] = (state.cart[id] || 0) + 1; saveCart(); renderCart();
            showToast(`${product.name} added to cart`);

            // flying image
            const cardImg = e.currentTarget.closest('.card').querySelector('img');
            if (cardImg) {
                const fly = cardImg.cloneNode(true);
                const r = cardImg.getBoundingClientRect();
                fly.style.position = 'fixed'; fly.style.left = r.left + 'px'; fly.style.top = r.top + 'px';
                fly.style.width = r.width + 'px'; fly.style.height = r.height + 'px'; fly.style.transition = 'transform 0.8s cubic-bezier(.2,.9,.2,1),opacity 0.6s';
                fly.style.zIndex = 2000; document.body.appendChild(fly);
                const cartRect = openCartBtn.getBoundingClientRect();
                requestAnimationFrame(() => {
                    fly.style.transform = `translate(${cartRect.left - r.left}px,${cartRect.top - r.top}px) scale(0.12) rotate(10deg)`;
                    fly.style.opacity = '0.2';
                });
                setTimeout(() => fly.remove(), 900);
            }
        }

        // ---------------------------
        // Quick view modal
        // ---------------------------
        let quickProductId = null;
        function onQuick(e) {
            const id = Number(e.currentTarget.dataset.id);
            const prod = PRODUCTS.find(p => p.id === id);
            if (!prod) return;
            quickProductId = id;
            quickImg.src = prod.img;
            quickTitle.textContent = prod.name;
            quickDesc.textContent = prod.desc;
            quickPrice.textContent = prod.price;
            quickModal.classList.add('open'); quickModal.removeAttribute('aria-hidden');
        }
        quickClose.addEventListener('click', () => { quickModal.classList.remove('open'); quickModal.setAttribute('aria-hidden', 'true') });
        quickAdd.addEventListener('click', () => {
            if (!quickProductId) return;
            state.cart[quickProductId] = (state.cart[quickProductId] || 0) + 1; saveCart(); renderCart();
            quickModal.classList.remove('open'); quickModal.setAttribute('aria-hidden', 'true');
            showToast('Added to cart');
        });

        // ---------------------------
        // CART open/close + overlay handling
        // ---------------------------
        function openCart() {
            cartPanel.classList.add('open'); overlay.classList.add('show'); cartPanel.setAttribute('aria-hidden', 'false');
        }
        function closeCart() {
            cartPanel.classList.remove('open'); overlay.classList.remove('show'); cartPanel.setAttribute('aria-hidden', 'true');
        }

        openCartBtn.addEventListener('click', () => {
            if (cartPanel.classList.contains('open')) closeCart(); else openCart();
        });
        document.getElementById('closeCartBtn').addEventListener('click', closeCart);
        overlay.addEventListener('click', () => {
            // close overlays & modals
            closeCart();
            quickModal.classList.remove('open'); quickModal.setAttribute('aria-hidden', 'true');
            authModal.classList.remove('open'); authModal.setAttribute('aria-hidden', 'true');
            overlay.classList.remove('show');
        });

        // ---------------------------
        // Login modal
        // ---------------------------
        openLogin.addEventListener('click', () => {
            authModal.classList.add('open'); authModal.removeAttribute('aria-hidden');
            overlay.classList.add('show');
        });
        authClose.addEventListener('click', () => { authModal.classList.remove('open'); authModal.setAttribute('aria-hidden', 'true'); overlay.classList.remove('show') });
        document.getElementById('authCancel').addEventListener('click', () => { authModal.classList.remove('open'); authModal.setAttribute('aria-hidden', 'true'); overlay.classList.remove('show') });
        document.getElementById('authSubmit').addEventListener('click', () => {
            showToast('Logged in (demo)');
            authModal.classList.remove('open'); authModal.setAttribute('aria-hidden', 'true'); overlay.classList.remove('show')
        });

        // ---------------------------
        // Add some sample offers to carousel
        // ---------------------------
        const OFFERS = [
            { img: 'https://images.unsplash.com/photo-1544025162-d76694265947?q=80&w=1400&auto=format&fit=crop', title: 'Fresh Fruits Sale' },
            { img: 'https://images.unsplash.com/photo-1542834369-f10ebf06d3cb?q=80&w=1400&auto=format&fit=crop', title: 'Organic Veggies' },
            { img: 'https://images.unsplash.com/photo-1502741126161-b048400d9b90?q=80&w=1400&auto=format&fit=crop', title: 'Daily Essentials' }
        ];

        function renderCarousel() {
            carouselTrack.innerHTML = '';
            carouselDots.innerHTML = '';
            OFFERS.forEach((o, i) => {
                const s = document.createElement('div'); s.className = 'slide';
                s.innerHTML = `<div style="padding:12px"><img src="${o.img}" alt="${o.title}" style="width:100%;border-radius:10px;height:200px;object-fit:cover"></div>`;
                carouselTrack.appendChild(s);

                const dot = document.createElement('div'); dot.className = 'dot' + (i === 0 ? ' active' : '');
                dot.addEventListener('click', () => moveCarousel(i));
                carouselDots.appendChild(dot);
            });

            // make carousel track width auto (slides are 100% due to CSS)
            startCarouselAuto();
        }

        let carouselIndex = 0, carouselTimer = null;
        function moveCarousel(i) {
            carouselIndex = i;
            carouselTrack.style.transform = `translateX(-${carouselIndex * 100}%)`;
            $all('.dot').forEach((d, idx) => d.classList.toggle('active', idx === carouselIndex));
        }
        function startCarouselAuto() {
            if (carouselTimer) clearInterval(carouselTimer);
            carouselTimer = setInterval(() => {
                carouselIndex = (carouselIndex + 1) % OFFERS.length;
                moveCarousel(carouselIndex);
            }, 3800);
        }

        // pause on hover
        carouselTrack.addEventListener('mouseenter', () => clearInterval(carouselTimer));
        carouselTrack.addEventListener('mouseleave', () => startCarouselAuto());

        // ---------------------------
        // Add/Remove functions
        // ---------------------------
        function addToCartById(id) {
            state.cart[id] = (state.cart[id] || 0) + 1;
            saveCart(); renderCart(); showToast('Added to cart');
        }

        // when clicking quick view add or product add
        function addToCartFromUI(id) {
            addToCartById(id);
        }

        // ---------------------------
        // Remove, update, initial render
        // ---------------------------
        function init() {
            // skeletons
            showSkeletons();
            // categories
            renderCategories();
            // show products after a tiny simulated load (600ms)
            setTimeout(() => {
                renderProducts();
                renderCarousel();
                renderCart();
                updateCartBadge();
            }, 600);
            setupSearch();
            // attach other handlers
            document.getElementById('searchBtn').addEventListener('click', () => {
                state.search = searchInput.value.trim();
                renderProducts();
                suggestionsEl.style.display = 'none';
            });

            // add-to-cart button in quick modal is wired above

            // checkout button demo: just clears cart for demo
            document.getElementById('checkoutBtn').addEventListener('click', () => {
                if (!Object.keys(state.cart).length) { showToast('Your cart is empty'); return }
                showToast('Checkout complete (demo), order placed');
                state.cart = {}; saveCart(); renderCart(); closeCart();
            });

            // close quick modal on overlay / escape
            document.addEventListener('keydown', (e) => { if (e.key === 'Escape') { quickModal.classList.remove('open'); authModal.classList.remove('open'); overlay.classList.remove('show'); closeCart(); } });

            // update cart badge on load
            updateCartBadge();
        }

        function updateCartBadge() {
            cartCountBadge.textContent = getCartCount();
        }

        // attach add buttons which may be added later
        function attachGlobalAddHandlers() {
            // handles dynamically created add buttons (if any)
            document.addEventListener('click', function (e) {
                if (e.target.matches('.addBtn') || e.target.closest('.addBtn')) {
                    const btn = e.target.matches('.addBtn') ? e.target : e.target.closest('.addBtn');
                    const id = Number(btn.dataset.id);
                    addToCartById(id);
                }
            });
        }

        // ---------------------------
        // Utilities hooking
        // ---------------------------
        function flashCartIcon() {
            const el = openCartBtn;
            el.animate([{ transform: 'scale(1)' }, { transform: 'scale(1.06)' }, { transform: 'scale(1)' }], { duration: 300 })
        }

        // update cart UI each time cart changes
        const cartObserver = new MutationObserver(() => {
            updateCartBadge();
            flashCartIcon();
        });

        cartObserver.observe(cartItemsWrap, { childList: true, subtree: true });

        // ---------------------------
        // finalize init
        // ---------------------------
        init();
        attachGlobalAddHandlers();

        // Ensure changes to cart update badge
        const originalSaveCart = saveCart;
        saveCart = function () { originalSaveCart(); renderCart(); updateCartBadge(); };

        // wire up quick modal close by clicking outside (use overlay)
        // overlay click already closes modals

        // show initial skeletons count -> hide when products shown
        // Done in init()

        // ----- extra: clicking product image opens quick view -----
        document.addEventListener('click', (e) => {
            const card = e.target.closest('.card');
            if (card && e.target.tagName !== 'BUTTON' && !e.target.classList.contains('quick')) {
                // open quick view for this card's first add button id
                const addBtn = card.querySelector('.add');
                if (addBtn) {
                    const id = Number(addBtn.dataset.id);
                    const prod = PRODUCTS.find(p => p.id === id);
                    if (prod) {
                        quickProductId = id;
                        quickImg.src = prod.img;
                        quickTitle.textContent = prod.name;
                        quickDesc.textContent = prod.desc;
                        quickPrice.textContent = prod.price;
                        quickModal.classList.add('open'); overlay.classList.add('show');
                    }
                }
            }
        });

        // ensure clicking quick-open button adds overlay
        quickModal.addEventListener('click', (e) => {
            if (e.target === quickModal) {
                quickModal.classList.remove('open'); overlay.classList.remove('show');
            } else {
                overlay.classList.add('show');
            }
        });

        // make sure overlay shows when modal open
        const observerModal = new MutationObserver(() => {
            if (quickModal.classList.contains('open') || authModal.classList.contains('open')) overlay.classList.add('show');
        });
        observerModal.observe(quickModal, { attributes: true });
        observerModal.observe(authModal, { attributes: true });

        // small: clicking quickAdd shows small confirmation
        quickAdd.addEventListener('click', () => {
            if (quickProductId) { addToCartById(quickProductId); overlay.classList.remove('show'); }
        });

        // ensure overlay hide when nothing open
        setInterval(() => {
            if (!quickModal.classList.contains('open') && !authModal.classList.contains('open') && !cartPanel.classList.contains('open')) overlay.classList.remove('show');
        }, 500);

    </script>
</body>

</html>